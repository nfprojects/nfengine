# @file   CMakeLists.txt
# @author LKostyra (costyrra.xl@gmail.com)
# @brief  CMake for nfCommon

FILE(GLOB NFCOMMON_SOURCES *.cpp)
FILE(GLOB NFCOMMON_HEADERS *.hpp)
FILE(GLOB NFCOMMON_LINUX_SOURCES Linux/*.cpp)
FILE(GLOB NFCOMMON_LINUX_HEADERS Linux/*.hpp)

MESSAGE("SOURCE_DIR: ${CMAKE_SOURCE_DIR}")

MESSAGE("Sources: ${NFCOMMON_SOURCES}")

# TODO these sources are not prepared for multi-platform.
#      Move them to Win directory and appropriately code headers.
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/Logger.cpp")
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/OutputStream.cpp")
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/InputStream.cpp")
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/Window.cpp")
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/Main.cpp")

# TODO Image.cpp is added here, because it relies on other nfCommon modules
LIST(REMOVE_ITEM NFCOMMON_SOURCES "${NFCOMMON_DIRECTORY}/Image.cpp")

MESSAGE("Sources: ${NFCOMMON_SOURCES}")

INCLUDE_DIRECTORIES(${NFE_ROOT_DIRECTORY}/nfEngineDeps/ ${NFCOMMON_DIRECTORY})

ADD_LIBRARY(nfCommon ${NFCOMMON_SOURCES} ${NFCOMMON_LINUX_SOURCES}
                     ${NFCOMMON_HEADERS} ${NFCOMMON_LINUX_HEADERS})
ADD_CUSTOM_COMMAND(TARGET nfCommon POST_BUILD COMMAND
                   ${CMAKE_COMMAND} -E copy $<TARGET_FILE:nfCommon> ${NFE_OUTPUT_DIRECTORY}/${targetfile})
